{% extends 'blog/base.html' %}
{% load static %}

{% block content %}
        <form action="" method="POST" id="comment-form">
            {% for field in form %}
                <div class="field">
                    {{ field.label_tag }}
                    {{ field }}
                    {% if field.help_text %}
                        <span class="helptext">{{ field.help_text }}</span>
                    {% endif %}
                </div>
            {% endfor %}
            {% csrf_token %}
            <div class="field">
                <button type="submit">送信</button>
            </div>
        </form>

        {% if post %}
            <button type="button" class="orange-button" id="delete">削除</button>
            <form action="{% url 'blog:post_delete' post.pk %}" method="POST" style="display: none" id="delete-form">
                {% csrf_token %}
                <button type="button" class="button is-primary hidden-modal" data-target="delete-modal">キャンセル</button>
                <button type="submit" class="button is-danger">本当に削除</button>
            </form>
        {% endif %}



{% endblock %}

{% block extra_css %}
    <!-- コードシンタックス、css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/dracula.min.css">
{% endblock %}

{% block extra_js %}
    {{ form.media }}
    <!-- コードシンタックス、js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script>
        for (const textarea of document.getElementsByTagName('textarea')) {
            textarea.addEventListener('blur', e => {
                for (const block of document.querySelectorAll('pre code')) {
                    hljs.highlightBlock(block);
                }
            });
        }

        document.getElementById('delete').addEventListener('click', e => {
            swal({
                title: "確認",
                text: "削除してよろしいですか？",
                icon: "warning",
                buttons: "Yes, delete it!",
            })
                .then(isConfirm => {
                    if (isConfirm) document.getElementById('delete-form').submit();
                });
        });
    </script>
{% endblock %}